if("undefined"==typeof DynamixAuth)var DynamixAuth={uuid:null,authListener:null,base_url_ip:"http://pairing.ambientdynamix.org/pairing/retrieveip.php?timestamp=",Enums:Object.freeze({QR_CODE_GENERATED:"QR_CODE_GENERATED",DYNAMIX_DEVICE_FOUND:"DYNAMIX_DEVICE_FOUND",DYNAMIX_DEVICE_NOT_FOUND:"DYNAMIX_DEVICE_NOT_FOUND"}),showQRCode:function(e,i,t,n){console.log("New QR code auth request from : "+e),void 0!==i.divId&&(elemId=i.divId),void 0===i.width&&(i.width=128),void 0===i.height&&(i.height=128);var o={};o.appName=e,Dynamix.pairing_token=Dynamix.generateGuid().substr(3,7),o.uuid=Dynamix.generateGuid().substr(3,7),DynamixAuth.uuid=o.uuid,o.salt=Dynamix.generateGuid().substr(3,7),o.type="pairing";var a=o.salt.concat(Dynamix.pairing_token);console.log("Salted Token : "+a),SHA256Hash=CryptoJS.SHA256(a),o.hashCode=SHA256Hash.toString(CryptoJS.enc.Base64);var r=JSON.stringify(o);console.log("Generating QR Code for : "+r);var u=document.getElementById(elemId);qrcode=new QRCode(u,{width:i.width,height:i.height,colorDark:"#000000",colorLight:"#ffffff"}),qrcode.makeCode(r),t(DynamixAuth.Enums.QR_CODE_GENERATED),n&&DynamixAuth.retrieveIp(t)},retrieveIp:function(e){if(void 0==DynamixAuth.uuid)throw{name:"Undefined uuid",message:"Method is probably called before the QR Code is displayed"};var i=60,t=function(){var n=DynamixAuth.base_url_ip+Date.now()+"&uuid="+DynamixAuth.uuid,o=new XMLHttpRequest;o.onreadystatechange=function(){try{if(4==o.readyState&&200==o.status){var n=convertToJsonObject(o.response).ip;console.log("Response> "+o.response),void 0!==n?(Dynamix.base_url="http://"+n,console.log("Dynamix.base_url >> "+Dynamix.base_url),e(DynamixAuth.Enums.DYNAMIX_DEVICE_FOUND)):i>0?(i--,setTimeout(t(),1e4)):(console.log("exiting retry loop"),e(DynamixAuth.Enums.DYNAMIX_DEVICE_NOT_FOUND))}}catch(a){console.log("Exception >> "+a.message),i>0?(i--,setTimeout(t(),1e4)):(console.log("exiting retry loop"),e(DynamixAuth.Enums.DYNAMIX_DEVICE_NOT_FOUND))}},o.open("GET",n,!0),o.send()};t()}};